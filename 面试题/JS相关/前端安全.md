# 1、XSS攻击是什么？
    要点：XSS是跨站脚本攻击、向目标网站插入恶意代码，大量用户访问网站时运行恶意脚本获取信息。

> 攻击者可以通过向web页面插入script代码，当用户浏览这个页面时，就会运行被插入的script代码，达到攻击者的目的。XSS的危害一般是泄露用户登录信息cookie，攻击者可以通过cookie绕过登录步骤直接进入站点。

## XSS分为反射型和存储型
    反射型就是临时通过url访问网站，网站服务器将恶意代码从url中取出，拼接在HTML中返回给浏览器，用户就会恶意执行代码。

    存储型就是将恶意代码以留言的形式保存在服务器数据库，任何访问网站的人都会收到攻击。

## 预防XSS共计的方案
- 基本方案是对数据进行严格的输出编码，比如HTML元素的编码，javascript编码，css编码，url编码等。

- 浏览器的防御和“X-XSS-Protection”有关，默认值为1.即默认打开XSS防御，可以防御反射型的XSS，不过作用有限，只能防御注入到HTML的节点内容或属性的XSS，例如URL参数中包含script标签。不建议只依赖此防御手段。

- 防御HTML节点，通过转义 <font color="yellow"><</font> 为 <font color="yellow">&lt</font> 以及 <font color="yellow">></font> 为 <font color="yellow">&gt</font> 来实现防御HTML节点内容。
- 防御HTML属性，通过转义 <font color="yellow">"</font> 为  <font color="yellow">&quto</font> 来实现防御，一般不转义空格，但是这要求属性必须带引号。

- 防御富文本
    - 将HTML代码段转化成树级结构的数据，遍历树的每一个节点，过滤节点的类型和属性。或进行特殊处理
    - 处理完成后你，将树级结构转化成HTML代码，开启浏览器的XSS防御：Http Only cookie，禁止JavaScript读取某些敏感Cookie，攻击者完成XSS注入后也无法窃取此Cookie。

## XSS的危害
- 获取cookie：网站中的登录一般都是用cookie作为某个用户的身份证明，这是服务器端返回的一段字符。如果cookie被攻击者拿到，那么就可以绕过密码登录。当空间、论坛如果可以被插入script代码，那么进入空间或者论坛的人的账号就可以轻易被攻击者获取。
- 恶意跳转：直接在页面中插入\
window.location.href进行跳转

## XSS的分类
- 反射型XSS(非持久型XSS)：通过URL参数直接注入
- 存储型XSS(持久型XS)：存储到数据库后读取时注入XSS的预防

# 2、CSRF攻击是什么？
    CSRF攻击又叫XSRF攻击，即跨站请求伪造。
    XSS是利用站点内的信任用户，而CSRF是通过伪造成受信任用户的请求来利用受信任的网站

## 2.1 CSRF攻击原理
1、用户C打开浏览器，访问受信任的网站A，输入用户名和密码请求登录网站。

2、在用户信息通过验证后，网站A产生cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；

3、用户未退出网站A前，在同一浏览器中，打开一个tab页访问网站B；

4、网站B接受到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A；

5、浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。

## 2.2 预防CSRF攻击
- 目前防御CSRF攻击主要有三种策略：
    - 验证HTTP Referer 字段；
    - 在请求地址中添加token并验证；
    - 在HTTP头中自定义属性并验证。